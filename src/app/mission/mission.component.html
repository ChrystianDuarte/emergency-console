<div class="card-deck">
  <div class="card">
    <div class="card-header">Mission</div>
    <div class="card-body">
      <mgl-map
        [style]="'mapbox://styles/mapbox/streets-v9'"
        [zoom]="[11]"
        [center]="center"
        (click)="setLocation($event)"
        [fitBounds]="bounds"
        [fitBoundsOptions]="boundsOptions"
        [accessToken]="accessToken"
        (load)="map = $event"
      >
        <mgl-marker [lngLat]="end" *ngIf="end" #endMarker>
          <div class="marker" [ngStyle]="endStyle"></div>
        </mgl-marker>
        <span *ngIf="start">
          <mgl-marker [lngLat]="start" #startMarker>
            <div class="marker" [ngStyle]="startStyle"></div>
          </mgl-marker>
          <mgl-popup [marker]="startMarker" [offset]="[0, -12]">
            <div class="card-text">
              <p>
                <strong>Full Name: </strong> {{ model.name }}<br />
                <strong>Phone Number: </strong> {{ model.phoneNumber }}<br />
                <strong>Boat Capacity: </strong> {{ model.boatCapacity }}<br />
                <strong>Has Medical: </strong> {{ model.medicalKit }}<br />
              </p>
            </div>
          </mgl-popup>
        </span>
        <mgl-geojson-source id="geojson" [data]="data"> </mgl-geojson-source>
        <mgl-layer id="route" type="line" source="geojson" [layout]="lineLayout" [paint]="linePaint"> </mgl-layer>
      </mgl-map>

      <app-legend [bottom]="'110px'"></app-legend>

      <div class="d-flex justify-content-center mt-3">
        <button type="button" class="btn btn-secondary btn-lg" [disabled]="!start" (click)="doAvailable()" *ngIf="missionStatus === null">
          Available
        </button>
        <button type="button" class="btn btn-warning btn-lg" (click)="doStart()" [disabled]="isLoading" *ngIf="missionStatus === 'Available'">
          <fa-icon [icon]="loadingIcon" [spin]="true" *ngIf="isLoading"></fa-icon> Start
        </button>
        <button type="button" class="btn btn-primary btn-lg" (click)="doPickedUp()" *ngIf="missionStatus === 'Start'">
          Picked Up
        </button>
        <button type="button" class="btn btn-success btn-lg" (click)="doRescued()" *ngIf="missionStatus === 'Picked Up'" [disabled]="isLoading">
          <fa-icon [icon]="loadingIcon" [spin]="true" *ngIf="isLoading"></fa-icon> Rescued
        </button>
      </div>
    </div>
  </div>
</div>
